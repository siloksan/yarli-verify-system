# MVP: Система верификации компонентов по QR

Цель: показать заказчику, как система предотвращает ошибки исполнителя
при выборе компонентов и партий в производстве.

---

## 1. Общая цель MVP

- [ ] Получать рецептуру (заказ на производство) из 1С при проведении документа
- [ ] Загружать рецептуру на клиент (PWA)
- [ ] Обязать исполнителя сканировать каждый компонент
- [ ] Показывать ошибку при сканировании неверного компонента или партии
- [ ] Фиксировать факт сканирования на сервере

---

## 2. Backend (NestJS + Postgres)

### 2.1 Базовая инфраструктура

- [ ] Инициализировать NestJS проект
- [ ] Подключить Postgres
- [ ] Настроить базовые env-переменные
- [ ] Поднять миграции / schema sync

---

### 2.2 Приём данных из 1С

- [ ] Эндпоинт: приём рецептуры при проведении документа
- [ ] Формат данных:
  - заказ (id / номер)
  - список компонентов
  - для каждого компонента — список партий с QR
- [ ] Валидация входящего запроса (минимальная)
- [ ] Сохранение данных в БД

---

### 2.3 API для клиента

- [ ] Получение списка заказов
- [ ] Получение одной рецептуры (компоненты + партии)
- [ ] Приём результата сканирования:
  - компонент
  - партия
  - результат (ok / wrong)
  - timestamp

---

### 2.4 Логирование (минимум)

- [ ] Лог входящих запросов от 1С
- [ ] Лог фактов сканирования

---

## 3. Модель данных (логическая)

- [ ] Заказ на производство
- [ ] Компоненты рецептуры
- [ ] Партии компонентов (QR)
- [ ] Факты сканирования

---

## 4. Клиент (React + PWA)

### 4.1 Базовая структура

- [ ] Инициализировать React PWA
- [ ] Настроить API-клиент
- [ ] Минимальный UI без авторизации

---

### 4.2 Экран выбора заказа

- [ ] Список доступных заказов
- [ ] Кнопка "Открыть заказ"

---

### 4.3 Экран рецептуры (ключевой экран)

- [ ] Отображение списка компонентов
- [ ] Статусы компонентов:
  - ❌ не проверен
  - ✅ проверен
  - ⚠️ неверный
- [ ] Счётчик прогресса (например: 5 / 20)

---

### 4.4 Сканирование QR

- [ ] Доступ к камере (mobile-first)
- [ ] Сканирование QR-кода
- [ ] Локальное сравнение QR с партиями компонента
- [ ] Обновление статуса компонента
- [ ] Отправка результата на сервер

---

### 4.5 Обработка ошибок

- [ ] Явное сообщение при неверном QR
- [ ] Возможность пересканировать компонент
- [ ] Сообщение при отсутствии интернета (online-only MVP)

---

## 5. Демонстрационный сценарий (обязательно)

- [ ] Подготовить тестовую рецептуру
- [ ] Подготовить корректный QR
- [ ] Подготовить заведомо неверный QR
- [ ] Показать заказчику:
  - корректный скан → ✅
  - неверный скан → ⚠️ с пояснением

---

## 6. Вне рамок MVP (на будущее)

- [ ] Авторизация и роли
- [ ] Запрет завершения при ошибках
- [ ] Офлайн-режим с очередью
- [ ] Отчёты и история операций
- [ ] Обратная интеграция в 1С

---

## 7. Критерии готовности MVP

- [ ] Данные приходят из 1С автоматически
- [ ] Исполнитель обязан сканировать каждый компонент
- [ ] Ошибка при неверном компоненте видна сразу
- [ ] Факт сканирования фиксируется
- [ ] MVP можно уверенно показать заказчику
